<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ØªÙ…Ø§Ø±ÙŠÙ†ÙŠ â€” Ø§Ø³Ø£Ù„ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background:#0d0d0d; color:#fff; font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif; margin:0; padding-top:72px; }
    /* Ø«Ø§Ø¨Øª Ø£Ø¹Ù„Ù‰ */
    header.fixed-top {
      position: fixed; top: 0; left: 0; right: 0;
      background: linear-gradient(90deg,#111827,#1f2937);
      color: #fef2f2;
      padding: 14px 20px;
      z-index: 1000;
      font-weight: 800;
      border-bottom: 2px solid rgba(248,113,113,0.07);
      text-align: center;
    }
    main.container { max-width:900px; margin: 30px auto; padding: 0 16px; }
    .card { background: #0f1724; border: 1px solid rgba(148,163,184,0.06); padding: 20px; border-radius: 12px; box-shadow: 0 6px 30px rgba(2,6,23,0.6); }
    textarea#q { width:100%; min-height:96px; resize:vertical; padding:12px; border-radius:8px; border:1px solid #334155; background:#e6edf7; color:#000; font-size:16px; }
    button.primary { width:100%; padding:12px; margin-top:12px; border-radius:10px; background: linear-gradient(135deg,#ef4444,#b91c1c); color:white; font-weight:700; border:none; cursor:pointer; }
    button.primary:active{ transform:scale(.997) }
    .resp { margin-top:14px; color:#e6eef8; background:#071025; padding:14px; border-radius:8px; min-height:70px; white-space:pre-wrap; }
    .small { color:#94a3b8; font-size:14px; margin-top:6px; }
    .footer-note { text-align:center; margin-top:18px; color:#9ca3af; font-size:13px; }
  </style>
</head>
<body>

  <header class="fixed-top">ØªÙ… Ø§Ù„ØµÙ†Ø¹ Ø¨ÙˆØ§Ø³Ø·Ø© Ø±Ø¹Ø¯ Ø§Ù„Ø£Ø³ÙˆØ¯</header>

  <main class="container">
    <div class="card">
      <h1 class="text-2xl font-extrabold mb-2" style="color:#fb7185">ğŸ’¬ Ø§Ø³Ø£Ù„ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</h1>
      <p class="small">Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ø§Ù‹ ÙˆØ§Ø­Ø¯Ø§Ù‹ Ø«Ù… Ø§Ø¶ØºØ· Ø¥Ø±Ø³Ø§Ù„ â€” Ø³ÙŠÙ‚ÙˆÙ… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø·Ù„Ø¨ Ø¥Ø¬Ø§Ø¨Ø© Ù…Ù† Hugging Face ÙˆÙŠØ¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©.</p>

      <textarea id="q" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§... (Ù…Ø«Ø§Ù„: ÙƒÙŠÙ Ø£Ø¨Ø¯Ø£ Ù†Ø¸Ø§Ù… ØªÙ…Ø§Ø±ÙŠÙ† Ù„Ù„Ù…Ø¨ØªØ¯Ø¦ÙŠÙ†ØŸ)"></textarea>
      <button class="primary" id="askBtn">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„</button>

      <div class="resp" id="result">Ø§Ù„Ø¬ÙˆØ§Ø¨ Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§...</div>
      <div class="footer-note">Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‡Ø°Ø§ Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø¨Ø§Ø´Ø± Ù…Ø¹ Ù…ÙˆØ¯ÙŠÙ„ Hugging Face Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªÙˆÙƒÙ† Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯.</div>
    </div>
  </main>

  <script>
    // === Ø¶Ø¹ ØªÙˆÙƒÙ† Hugging Face Ù‡Ù†Ø§ (Ø§Ù„Ø°ÙŠ Ø²ÙˆØ¯ØªÙ†ÙŠ Ø¨Ù‡) ===
    const HF_TOKEN = "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";

    // Ø§Ø®ØªØ± Ù…ÙˆØ¯ÙŠÙ„ Ù…ÙˆØ«ÙˆÙ‚: Ø³Ø£Ø³ØªØ®Ø¯Ù… Ù‡Ù†Ø§ "tiiuae/falcon-7b-instruct" ÙƒØ®ÙŠØ§Ø± Ø´Ø§Ø¦Ø¹.
    // Ø¥Ø°Ø§ ÙˆØ§Ø¬Ù‡Øª Ù…Ø´Ø§ÙƒÙ„ØŒ ÙŠÙ…ÙƒÙ† ØªØºÙŠÙŠØ±Ù‡ Ø¥Ù„Ù‰ Ù…ÙˆØ¯ÙŠÙ„ Ø¢Ø®Ø± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ HF.
    const MODEL = "tiiuae/falcon-7b-instruct";

    const btn = document.getElementById("askBtn");
    const qEl = document.getElementById("q");
    const resEl = document.getElementById("result");

    btn.addEventListener("click", ask);

    async function ask() {
      const question = qEl.value.trim();
      if (!question) {
        resEl.textContent = "âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø³Ø¤Ø§Ù„ Ø£ÙˆÙ„Ø§Ù‹.";
        return;
      }

      // ÙˆØ§Ø¬Ù‡Ø© Ù…Ø³ØªØ®Ø¯Ù…: Ø¥Ø´Ø§Ø±Ø© Ø§Ù†ØªØ¸Ø§Ø±
      resEl.textContent = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© â€” Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...";

      try {
        // Ù†Ø¬Ù‡Ø² Ù…ÙˆØ¬Ù‡ ÙˆØ§Ø¶Ø­ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù„ÙŠØ­Ø³Ù† Ø¬ÙˆØ¯Ø© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
        const prompt = `Ø£Ø¬Ø¨ Ø¹Ù† Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„ÙˆØ§Ø¶Ø­Ø© ÙˆØ§Ù„Ù…Ø®ØªØµØ±Ø©:\n\n${question}`;

        // Ø·Ù„Ø¨ POST Ø¥Ù„Ù‰ endpoint Ø§Ù„Ø®Ø§Øµ Ø¨Ù€ Hugging Face Inference API
        const response = await fetch(`https://api-inference.huggingface.co/models/${MODEL}`, {
          method: "POST",
          headers: {
            "Authorization": "Bearer " + HF_TOKEN,
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            inputs: prompt,
            parameters: {
              max_new_tokens: 256,
              do_sample: false
            }
          })
        });

        // Ø­Ø§ÙˆÙ„ ØªÙØ±ÙŠØº Ø±Ø¯ JSON
        const data = await response.json();
        console.log("HuggingFace response:", data);

        // Ø¥Ø°Ø§ Ø£Ø¹Ø§Ø¯ Ø®Ø·Ø£ Ù…Ù† Ø§Ù„Ø³ÙŠØ±ÙØ±
        if (data.error) {
          resEl.textContent = "âš ï¸ Ø­ØµÙ„ Ø®Ø·Ø£ Ù…Ù† Ø®Ø¯Ù…Ø© Hugging Face: " + data.error;
          return;
        }

        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù†Øµ Ù…Ù† ØµÙŠØº Ù…Ø®ØªÙ„ÙØ© Ù…Ù…ÙƒÙ†Ø©
        let answer = "";

        // Ø´Ø§Ø¦Ø¹: Ù…ØµÙÙˆÙØ© Ù…Ø¹ generated_text
        if (Array.isArray(data) && data[0]?.generated_text) {
          answer = data[0].generated_text;
        }
        // Ø¨Ø¹Ø¶ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ ØªØ¹ÙŠØ¯ ÙƒØ§Ø¦Ù† Ø¨Ù‡ generated_text
        else if (data.generated_text) {
          answer = data.generated_text;
        }
        // Ø¨Ø¹Ø¶ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ù‚Ø¯ ØªØ±Ø¬Ø¹ key Ø¨Ø§Ø³Ù… 'output' Ø£Ùˆ 'output_text'
        else if (Array.isArray(data) && data[0]?.output_text) {
          answer = data[0].output_text;
        }
        else if (data[0]?.text) {
          answer = data[0].text;
        }
        // ÙÙŠ Ø­Ø§Ù„ Ù„Ù… Ù†Ø¬Ø¯ Ø´ÙƒÙ„ Ù…Ø¹Ø±ÙˆÙØŒ Ø­Ø§ÙˆÙ„ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù‰ Ù†Øµ Ø®Ø§Ù…
        else {
          answer = JSON.stringify(data, null, 2);
        }

        // Ø£Ø²Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¥Ø°Ø§ ØªÙ… ØªÙƒØ±Ø§Ø±Ù‡ ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© (Ø¨Ø¹Ø¶ Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ ØªÙØ¹ÙŠØ¯ prompt+answer)
        if (answer.startsWith(prompt)) {
          answer = answer.slice(prompt.length).trim();
        } else {
          // Ø£Ø­ÙŠØ§Ù†Ø§Ù‹ Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„ ÙŠØ¹ÙŠØ¯ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø«Ù… Ø¥Ø¬Ø§Ø¨Ø© Ù…Ø®ØªÙ„ÙØ© - Ù†Ø­Ø§ÙˆÙ„ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠ
          const qShort = question.split('\n')[0];
          if (answer.includes(qShort)) {
            answer = answer.replace(qShort, "").trim();
          }
        }

        // Ø£Ø®ÙŠØ±Ø§Ù‹ Ù†Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø£Ùˆ Ø±Ø³Ø§Ù„Ø© Ù…Ù„Ø§Ø¦Ù…Ø©
        if (answer) {
          resEl.textContent = answer;
        } else {
          resEl.textContent = "âš ï¸ Ù„Ù… Ø£Ø³ØªÙ„Ù… Ø¥Ø¬Ø§Ø¨Ø© Ù…ÙÙ‡ÙˆÙ…Ø© Ù…Ù† Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„.";
        }

      } catch (err) {
        console.error("Request error:", err);
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø®Ø·Ø£ CORS Ø£Ùˆ Ø´Ø¨ÙƒÙŠ Ø³Ù†Ø¸Ù‡Ø± Ø±Ø³Ø§Ù„Ø© Ù…ÙÙŠØ¯Ø©
        resEl.textContent = "âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„. Ø¥Ø°Ø§ Ø¸Ù‡Ø± Ø®Ø·Ø£ CORS ÙÙŠ Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„ØŒ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªØ´ØºÙŠÙ„ Ø¨Ø±ÙˆÙƒØ³ÙŠ Ø£Ùˆ ÙˆØ¶Ø¹ Ø§Ù„ØªÙˆÙƒÙ† ÙÙŠ Ø®Ø§Ø¯Ù… Ø®Ù„ÙÙŠ (backend). ØªÙØ§ØµÙŠÙ„ ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„.";
      }
    }
  </script>
</body>
</html>
